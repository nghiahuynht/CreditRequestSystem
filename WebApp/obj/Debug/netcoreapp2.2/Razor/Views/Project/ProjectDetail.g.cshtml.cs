#pragma checksum "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "63ad4c92b5eb6f4a81551ff70c83b7237031b09b"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Project_ProjectDetail), @"mvc.1.0.view", @"/Views/Project/ProjectDetail.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/Project/ProjectDetail.cshtml", typeof(AspNetCore.Views_Project_ProjectDetail))]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#line 1 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
using System.Globalization;

#line default
#line hidden
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"63ad4c92b5eb6f4a81551ff70c83b7237031b09b", @"/Views/Project/ProjectDetail.cshtml")]
    public class Views_Project_ProjectDetail : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<DAL.Models.ProjectFinancialSummar.ProjectFinancialSummarViewModel>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#line 2 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
  
    ViewData["Title"] = "Thông tin nguồn thu";
    Layout = "~/Views/Shared/_Layout.cshtml";

#line default
#line hidden
            BeginContext(131, 2, true);
            WriteLiteral("\r\n");
            EndContext();
            BeginContext(207, 30, true);
            WriteLiteral("\r\n<input hidden id=\"projectId\"");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 237, "\"", 266, 1);
#line 9 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 245, Model.ProjectInfo.Id, 245, 21, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(267, 162, true);
            WriteLiteral(" />\r\n<section class=\"content-header\">\r\n    <div class=\"container-fluid\">\r\n        <div class=\"row mb-2\">\r\n            <div class=\"col-sm-6\">\r\n                <h1>");
            EndContext();
            BeginContext(431, 17, false);
#line 14 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                Write(ViewData["Title"]);

#line default
#line hidden
            EndContext();
            BeginContext(449, 2275, true);
            WriteLiteral(@"</h1>
            </div>
            <div class=""col-sm-6"">
                <ol class=""breadcrumb float-sm-right"">
                    <li class=""breadcrumb-item"">
                        <input type=""button"" value=""Import kế hoạch phân bổ nguồn thu"" class=""btn bg-primary"" id=""btn-import-planing-for-project"" onclick=""CreateProject()"" />
                    </li>

                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>
<section class=""content"">
    <div class=""card card-warning card-outline card-tabs"">
        <div class=""card-header p-0 pt-1 border-bottom-0"">
            <ul class=""nav nav-tabs"" id=""custom-tabs-three-tab"" role=""tablist"">
                <li class=""nav-item"">
                    <a class=""nav-link active"" id=""project-detail-tab"" data-toggle=""pill"" href=""#project-detail-tab-content"" role=""tab"" aria-controls=""custom-tabs-three-home"" aria-selected=""true"">THÔNG TIN NGUỒN THU</a>
                </li>
                <li class=""nav");
            WriteLiteral(@"-item"">
                    <a class=""nav-link"" id=""project-history-tab"" data-toggle=""pill"" href=""#project-history-tab-content"" role=""tab"" aria-controls=""custom-tabs-three-messages"" aria-selected=""false"">LỊCH SỬ ĐIỀU CHỈNH</a>
                </li>



            </ul>
        </div>
        <div class=""card-body"">

            <div class=""tab-content"">
                <div class=""tab-pane fade active show"" id=""project-detail-tab-content"" role=""tabpanel"" aria-labelledby=""custom-tabs-three-home-tab"">
                    <fieldset class=""border rounded-1 pb-3 pe-3 ps-3 mb-3"">
                        <legend class=""float-none w-auto px-3 text-uppercase fw-bold fs-2 mb-0 text-blue"">Thông tin tổng quát</legend>
                        <form class=""form-horizontal"" id=""frmCreateProject"">
                            <div class=""row"">
                                <div class=""col-sm-6"">
                                    <div class=""form-group row"">
                                        <label ");
            WriteLiteral("class=\"col-md-4 col-form-label\">Thời gian thực hiện</label>\r\n                                        <div class=\"input-group-append col-md-8\">\r\n                                            <input type=\"date\" class=\"form-control\"");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 2724, "\"", 2784, 1);
#line 54 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 2732, Model.ProjectInfo.TimeStart?.ToString("yyyy-MM-dd"), 2732, 52, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(2785, 203, true);
            WriteLiteral(" name=\"thoi_gian_bat_dau\" id=\"a_thoi_gian_bat_dau\" readonly />\r\n                                            <h3>-</h3>\r\n                                            <input type=\"date\" class=\"form-control\"");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 2988, "\"", 3046, 1);
#line 56 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 2996, Model.ProjectInfo.TimeEnd?.ToString("yyyy-MM-dd"), 2996, 50, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(3047, 503, true);
            WriteLiteral(@" name=""thoi_gian_ket_thuc"" id=""a_thoi_gian_ket_thuc"" readonly />
                                        </div>
                                    </div>
                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Mã nguồn thu<span class=""text-red"">*</span></label>
                                        <div class=""col-md-8"">
                                            <input type=""text"" class=""form-control""");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 3550, "\"", 3588, 1);
#line 62 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 3558, Model.ProjectInfo.ProjectCode, 3558, 30, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(3589, 518, true);
            WriteLiteral(@" name=""ma_du_an"" id=""a_ma_du_an"" readonly />
                                        </div>
                                    </div>
                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Tên nguồn thu<span class=""text-red"">*</span></label>
                                        <div class=""col-md-8"">
                                            <input type=""text"" class=""form-control"" id=""a_ten_du_an"" name=""ten_du_an""");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 4107, "\"", 4145, 1);
#line 68 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 4115, Model.ProjectInfo.ProjectName, 4115, 30, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(4146, 498, true);
            WriteLiteral(@" readonly />
                                        </div>
                                    </div>
                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Căn cứ pháp lý <span class=""text-red"">*</span></label>
                                        <div class=""col-md-8"">
                                            <input type=""text"" class=""form-control"" id=""a_can_cu_phap_ly"" name=""can_cu_phap_ly""");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 4644, "\"", 4681, 1);
#line 74 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 4652, Model.ProjectInfo.LegalBasis, 4652, 29, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(4682, 975, true);
            WriteLiteral(@" readonly />
                                        </div>
                                    </div>

                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Người tạo</label>
                                        <div class=""col-md-8"">
                                            <input type=""text"" class=""form-control"" value=""admin"" disabled=""disabled"" />
                                        </div>
                                    </div>
                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Ngày tạo</label>
                                        <div class=""col-md-8"">
                                            <div class=""input-group date"">
                                                <input type=""text"" id=""DateRequest"" disabled=""disabled"" name=""DateRequest""");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 5657, "\"", 5701, 1);
#line 88 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 5665, DateTime.Now.ToString("dd/MM/yyyy"), 5665, 36, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(5702, 820, true);
            WriteLiteral(@" class=""form-control"">
                                                <span class=""input-group-addon group-date-icon""><i class=""far fa-calendar-alt""></i></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class=""col-sm-6"">

                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Tổng hạn mức <span class=""text-red"">*</span></label>
                                        <div class=""col-md-8"">
                                            <input type=""text"" class=""form-control"" style=""font-weight:bold;"" name=""tong_han_muc"" id=""a_tong_han_muc""");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 6522, "\"", 6560, 1);
#line 100 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 6530, Model.ProjectInfo.TotalAmount, 6530, 30, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(6561, 106, true);
            WriteLiteral(" readonly />\r\n                                        </div>\r\n                                    </div>\r\n");
            EndContext();
            BeginContext(7477, 439, true);
            WriteLiteral(@"                                    <div class=""form-group row"">
                                        <label class=""col-md-4 col-form-label"">Ghi chú</label>
                                        <div class=""col-md-8"">
                                            <textarea class=""form-control"" id=""a_ghi_chu"" rows=""3"" readonly></textarea>
                                        </div>
                                    </div>
");
            EndContext();
            BeginContext(8392, 686, true);
            WriteLiteral(@"                                    <div class=""form-group row"">
                                        <div class=""col-md-4 pt-3"">

                                            <!--<input type=""button"" value=""Đính kèm"" class=""btn btn-warning"" onclick=""UploadFileProject()"" />-->
                                            <!-- Input file ẩn -->
                                            <!--<input type=""file"" id=""fileInputProject"" style=""display: none;"" />-->
                                        </div>
                                        <div class=""col-md-8"">
                                            <table class=""table"" width=""100%"" id=""table_Attact_File"">
");
            EndContext();
#line 133 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                                 foreach (var file in Model.ListFileAttach)
                                                {

#line default
#line hidden
            BeginContext(9222, 580, true);
            WriteLiteral(@"                                                    <tr>
                                                        <td width=""40px"" style=""text-align:center;"">
                                                            <a>
                                                                <span class=""fa fa-download""></span>
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <a");
            EndContext();
            BeginWriteAttribute("href", " href=\"", 9802, "\"", 9822, 1);
#line 142 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 9809, file.URLPath, 9809, 13, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(9823, 17, true);
            WriteLiteral(" target=\"_blank\">");
            EndContext();
            BeginContext(9841, 13, false);
#line 142 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                                                                               Write(file.FileName);

#line default
#line hidden
            EndContext();
            BeginContext(9854, 130, true);
            WriteLiteral("</a>\r\n                                                        </td>\r\n\r\n                                                    </tr>\r\n");
            EndContext();
#line 146 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                                }

#line default
#line hidden
            BeginContext(10035, 1284, true);
            WriteLiteral(@"                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </fieldset>

                    <fieldset class=""border rounded-1 pb-3 pe-3 ps-3 mb-3"" id=""regon_hang_muc_phan_bo"" style=""display:block"">
                        <legend class=""float-none w-auto px-3 text-uppercase fw-bold fs-2 mb-0 text-blue"">Hạng mục phân bổ chi tiết</legend>
                        <table class=""table table-bordered"">
                            <thead>
                                <tr>
                                    <th>Nhóm hoạt động</th>
                                    <th>Mục chi</th>
                                    <th>Tiêu chuẩn</th>
                                    <th>SL</th>
                                    <th>Đơn giá</th>
                                    <th>Thành tiền</t");
            WriteLiteral(@"h>
                                    <th>Ghi chú</th>
                                    <th width=""90px""></th>
                                </tr>
                            </thead>
                            <tbody id=""table_phan_bo_chi_tiet"">
");
            EndContext();
#line 171 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                 foreach (var detail in Model.ListProjectDetail)
                                {

#line default
#line hidden
            BeginContext(11436, 49, true);
            WriteLiteral("                                    <tr data-id=\"");
            EndContext();
            BeginContext(11486, 9, false);
#line 173 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                            Write(detail.Id);

#line default
#line hidden
            EndContext();
            BeginContext(11495, 48, true);
            WriteLiteral("\">\r\n                                        <td>");
            EndContext();
            BeginContext(11544, 24, false);
#line 174 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.ActivityGroupName);

#line default
#line hidden
            EndContext();
            BeginContext(11568, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(11620, 16, false);
#line 175 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.ExpenseId);

#line default
#line hidden
            EndContext();
            BeginContext(11636, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(11688, 15, false);
#line 176 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.Standard);

#line default
#line hidden
            EndContext();
            BeginContext(11703, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(11755, 15, false);
#line 177 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.Quantity);

#line default
#line hidden
            EndContext();
            BeginContext(11770, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(11822, 54, false);
#line 178 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.Price?.ToString("N0", new CultureInfo("de-DE")));

#line default
#line hidden
            EndContext();
            BeginContext(11876, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(11928, 60, false);
#line 179 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.TotalAmount?.ToString("N0", new CultureInfo("de-DE")));

#line default
#line hidden
            EndContext();
            BeginContext(11988, 51, true);
            WriteLiteral("</td>\r\n                                        <td>");
            EndContext();
            BeginContext(12040, 12, false);
#line 180 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                       Write(detail.Notes);

#line default
#line hidden
            EndContext();
            BeginContext(12052, 147, true);
            WriteLiteral("</td>\r\n                                        <td style=\"text-align:center;\">\r\n                                            <span class=\"fa fa-eye\"");
            EndContext();
            BeginWriteAttribute("onclick", " onclick=\"", 12199, "\"", 12231, 3);
            WriteAttributeValue("", 12209, "ViewDetail(", 12209, 11, true);
#line 182 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 12220, detail.Id, 12220, 10, false);

#line default
#line hidden
            WriteAttributeValue("", 12230, ")", 12230, 1, true);
            EndWriteAttribute();
            BeginContext(12232, 85, true);
            WriteLiteral("></span>&nbsp;\r\n                                            <span class=\"fa fa-trash\"");
            EndContext();
            BeginWriteAttribute("onclick", " onclick=\"", 12317, "\"", 12358, 3);
            WriteAttributeValue("", 12327, "RemoveProjectDetail(", 12327, 20, true);
#line 183 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
WriteAttributeValue("", 12347, detail.Id, 12347, 10, false);

#line default
#line hidden
            WriteAttributeValue("", 12357, ")", 12357, 1, true);
            EndWriteAttribute();
            BeginContext(12359, 100, true);
            WriteLiteral("></span>\r\n                                        </td>\r\n                                    </tr>\r\n");
            EndContext();
#line 186 "D:\Projects\OnGit\CreditRequestSystem\WebApp\Views\Project\ProjectDetail.cshtml"
                                }

#line default
#line hidden
            BeginContext(12494, 2356, true);
            WriteLiteral(@"                            </tbody>
                        </table>
                    </fieldset>






                </div>
                <div id=""project-history-tab-content"" class=""tab-pane fade"">
                    <br />
                    <table class=""table table-bordered"">
                        <tr style=""background:#f4f4f4;"">
                            <th>Lần</th>
                            <th>Tên</th>
                            <th>Căn cứ pháp lý</th>
                            <th>Thời gian thực hiện</th>
                            <th>Tổng tiền</th>
                            <th>Trạng thái</th>
                            <th>Ghi chú</th>
                            <th>Người chỉnh</th>
                            <th>Ngày chỉnh</th>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Dự án dự toán kinh phí tổ chức hội thảo</td>
                            <td>Quyết định 12");
            WriteLiteral(@"4/QĐ</td>
                            <td>2024-2025</td>
                            <td>500,000,000</td>
                            <th><span class='badge badge-primary badge-status'>Đang hiệu lực</span></th>
                            <td>Năm 2025: 50.000.000</td>
                            <td>Admin</td>
                            <td>13/11/2024</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Dự án dự toán kinh phí tổ chức hội thảo</td>
                            <td>Quyết định 6/QĐ</td>
                            <td>2024-2025</td>
                            <td>450,000,000</td>
                            <th><span class='badge badge-primary badge-status'>Đang hiệu lực</span></th>
                            <td>Năm 2025: 50.000.000</td>
                            <td>Admin</td>
                            <td>13/11/2024</td>
                        </tr>
                    </table>
       ");
            WriteLiteral(@"         </div>
            </div>


        </div>
    </div>
</section>


<div class=""modal fade show"" data-backdrop=""static"" id=""modal-project-itemline"" aria-modal=""true"" role=""dialog"">
    <div class=""modal-dialog modal-xl"" id=""modal-hang-muc-phan-bo"">

    </div>

</div>








");
            EndContext();
            DefineSection("scripts", async() => {
                BeginContext(14867, 27197, true);
                WriteLiteral(@"
    <!-- Thêm jQuery Validate -->
    <script src=""https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js""></script>

    <script>
        var listFileAttact = [];
        $(document).ready(function () {
            formatTotalAmount();
            $(""#btn-add-project-item"").click(function () {
                $.ajax({
                    url: '/Project/FormCreateProjectDetail',
                    type: 'GET',
                    data: {},
                    contentType: 'application/json',
                    success: function (response) {
                        $('#modal-hang-muc-phan-bo').html("""");
                        $('#modal-hang-muc-phan-bo').append(response);
                        $(""#modal-project-itemline"").modal();
                    },
                    error: function (xhr, status, error) {

                        alert('Có lỗi khi gửi yêu cầu!');
                    }
                });


            });

            // Khi ng");
                WriteLiteral(@"ười dùng chọn file
            $('#fileInputProject').on('change', function () {

                const file = this.files[0]; // Lấy file được chọn
                if (file) {
                    // Upload file
                    const fileData = new FormData();
                    fileData.append('file', this.files[0]);

                    $.ajax({
                        url: '/FileUpload/UploadFile', // Đường dẫn đến API xử lý file
                        type: 'POST',
                        data: fileData,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            if (response.success == true && response.fileNameAttactId > 0) {
                                const html = `
                                                        <tr>
                                                            <td width=""40px"" style=""text-align:center;"">
                                    ");
                WriteLiteral(@"                            <a  target=""_blank"">
                                                                    <span class=""fa fa-download""></span>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <a href=""${response.filePath}"" target=""_blank"">${response.fileName}</a>
                                                            </td>
                                                             <td width=""40px"" style=""text-align:center;color:crimson;"">
                                                                <span class=""fa fa-trash delete-file""
                                                                      data-id=""${response.fileNameAttactId}""
                                                                      style=""cursor:pointer;""
                                ");
                WriteLiteral(@"                                      onclick=""RemoveFile(${response.fileNameAttactId})""></span>
                                                            </td>
                                                        </tr>
                                                    `;

                                $('#table_Attact_File').append(html)
                            }
                            listFileAttact.push(response.fileNameAttactId)
                            toastr.success('Tải file thành công!', 'Thành công', { positionClass: ""toast-top-center"" });
                        },
                        error: function () {
                            toastr.error('Có lỗi khi tải file!', 'Lỗi', { positionClass: ""toast-top-center"" });
                        }
                    });
                }
            });



           



        });

        function RemoveFile(fileId) {
            Swal.fire({
                title: 'Bạn có chắc chắn?',
               ");
                WriteLiteral(@" text: ""Bạn sẽ không thể hoàn tác hành động này!"",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Xóa',
                cancelButtonText: 'Hủy'
            }).then((result) => {
                if (result.isConfirmed) {
                    $(`span[data-id=""${fileId}""]`).closest('tr').remove();
                    listFileAttact = listFileAttact.filter(x => x != fileId);
                    toastr.success('Xóa file thành công!', 'Thành công');
                }
            });
        }

        function CreateProject() {

            var isValidate = validateData();

            if (isValidate == true) {

                var dataPost = {
                    Id: 0,
                    ProjectCode: $(""#a_ma_du_an"").val(),
                    ProjectName: $(""#a_ten_du_an"").val(),
                    LegalBasis: $(""#a_can_cu_phap_ly"").val");
                WriteLiteral(@"(),
                    TimeStart: $(""#a_thoi_gian_bat_dau"").val(),
                    TimeEnd: $(""#a_thoi_gian_ket_thuc"").val(),
                    TotalAmount: $(""#a_tong_han_muc"").val(),
                    StatusText: document.getElementById(""a_trang_thai"").innerText,
                    Notes: $(""#a_ghi_chu"").val(),
                    FileAttach: listFileAttact
                };
                // Gửi yêu cầu AJAX
                console.log(""dataPost"", dataPost);
                $.ajax({
                    url: '/Project/CreateProjectFinancialSummar',
                    type: 'POST',
                    data: JSON.stringify(dataPost),
                    contentType: 'application/json',
                    success: function (response) {
                        if (response.success) {
                            console.log(response)
                            toastr.success('Nguồn thu đã được tạo thành công!', 'Thành công', { positionClass: ""toast-top-center"" });
              ");
                WriteLiteral(@"              $(""#projectId"").val(response.projectId);
                            document.getElementById(""regon_hang_muc_phan_bo"").style.display = ""block"";

                        } else {
                            toastr.error('Có lỗi khi nguồn thu. Vui lòng thử lại!', 'Lỗi', { positionClass: ""toast-top-center"" });
                        }
                    },
                    error: function (xhr, status, error) {
                        // Xử lý khi có lỗi xảy ra trong quá trình gọi AJAX
                        alert('Có lỗi khi gửi yêu cầu!');
                    }
                });
            }
        }

        function UploadFileProject() {
            $('#fileInputProject').click();
        }

        function validateData() {
            var resultValid = $(""#frmCreateProject"").validate({
                rules: {
                    ""ten_du_an"": {
                        required: true,
                    },
                    ""ma_du_an"": {
                 ");
                WriteLiteral(@"       required: true,
                    },
                    ""can_cu_phap_ly"": {
                        required: true,
                    },
                    ""thoi_gian_bat_dau"": {
                        required: true,
                    },
                    ""thoi_gian_ket_thuc"": {
                        required: true,
                    },
                    ""tong_han_muc"": {
                        required: true,
                        number: true,
                        min: 1
                    },

                },
                messages: {
                    ""ten_du_an"": ""Tên nguồn thu không được để trống!"",
                    ""ma_du_an"": ""Mã nguồn thu không được để trống!"",
                    ""can_cu_phap_ly"": ""Căn cứ pháp lý không được để trống!"",
                    ""thoi_gian_bat_dau"": ""Thời gian thực hiện không được để trống!"",
                    ""thoi_gian_ket_thuc"": ""Thời gian thực hiện không được để trống!"",
                    ""tong_han_mu");
                WriteLiteral(@"c"": {
                        required: ""Tổng tiền không được để trống!"",
                        number: ""Tổng tiền phải là số!"",
                        min: ""Tổng tiền phải lớn hơn 0!""
                    }
                },

            }).form();

            return resultValid;
        }

        function showhideSoTienDaSuDung() {
            var ishow = document.getElementById(""a_luy_ke"").getAttribute(""data-value"");
            var iconElement = document.getElementById(""icon_show_hide"");
            if (ishow == ""show"") {
                document.getElementById('a_luy_ke').type = 'password';
                document.getElementById(""a_luy_ke"").setAttribute('data-value', 'hide');
                iconElement.classList.remove('fa-eye');
                iconElement.classList.add('fa-eye-slash');
            } else {
                document.getElementById('a_luy_ke').type = 'text';
                document.getElementById(""a_luy_ke"").setAttribute('data-value', 'show');
              ");
                WriteLiteral(@"  iconElement.classList.remove('fa-eye-slash');
                iconElement.classList.add('fa-eye');
            }
        }

        //-----DETAIL------//
        function CreateProjectDetail() {

            var isValidateDetail = validateDataDetail();
            if (isValidateDetail == true) {
                if ($(""#projectId"").val() == """" || $(""#projectId"").val() == undefined) {
                    toastr.error('ProjectId null. Vui lòng thử lại!', 'Lỗi', { positionClass: ""toast-top-center"" });
                    return;
                }
                var dataPost = {
                    Id: parseInt($(""#ProjectDetailId"").val()),
                    ProjectId: parseInt($(""#projectId"").val()),
                    ActivityGroupId: parseInt($(""#a_nhom_hoat_dong"").val()),
                    ExpenseItem: $(""#a_muc_chi"").val(),
                    Standard: $(""#a_tieu_chuan"").val(),
                    Quantity: $(""#a_so_luong"").val() == """" ? 0 : parseInt($(""#a_so_luong"").val()),
    ");
                WriteLiteral(@"                Price: $(""#a_don_gia_khong_format"").val() == """" ? 0 : parseFloat($(""#a_don_gia_khong_format"").val()),
                    TotalAmount: parseFloat($(""#a_thanh_tien_khong_format"").val()),
                    Notes: $(""#a_ghi_chu_tt_chi_tiet"").val(),

                };
                // Gửi yêu cầu AJAX
                console.log(""dataPost"", dataPost);
                $.ajax({
                    url: '/Project/CreateProjectFinancialDetail',
                    type: 'POST',
                    data: JSON.stringify(dataPost),
                    contentType: 'application/json',
                    success: function (response) {
                        if (response.success) {
                            var nhomhoatdongtext = $(""#a_nhom_hoat_dong option:selected"").text();

                            if (dataPost.Id == 0) {
                                const htmldt = `
                                         <tr data-id=${response.projectDetailId}>
                       ");
                WriteLiteral(@"                     <td>${nhomhoatdongtext}</td>
                                            <td>${dataPost.ExpenseItem}</td>
                                            <td>${dataPost.Standard}</td>
                                            <td>${dataPost.Quantity}</td>
                                            <td>${dataPost.Price}</td>
                                            <td>${dataPost.TotalAmount}</td>
                                            <td>${dataPost.Notes}</td>
                                            <td style=""text-align:center;"">
                                                <span class=""fa fa-eye"" onclick=""ViewDetail(${response.projectDetailId})""></span>&nbsp;
                                                 <span class=""fa fa-edit"" onclick=""EditProjectDetail(${response.projectDetailId})""></span>&nbsp;
                                                 <span class=""fa fa-trash"" onclick=""RemoveProjectDetail(${response.projectDetailId})""></span>
                    ");
                WriteLiteral(@"                        </td>
                                        </tr>
                                        `;
                                $('#table_phan_bo_chi_tiet').append(htmldt);
                            }
                            else {
                                const htmldtUpdate = `
                                            <td>${nhomhoatdongtext}</td>
                                            <td>${dataPost.ExpenseItem}</td>
                                            <td>${dataPost.Standard}</td>
                                            <td>${dataPost.Quantity}</td>
                                            <td>${dataPost.Price}</td>
                                            <td>${dataPost.TotalAmount}</td>
                                            <td>${dataPost.Notes}</td>
                                            <td style=""text-align:center;"">
                                                 <span class=""fa fa-eye"" onclick=""ViewDetail(${respo");
                WriteLiteral(@"nse.projectDetailId})""></span>&nbsp;
                                                 <span class=""fa fa-edit"" onclick=""EditProjectDetail(${response.projectDetailId})""></span>&nbsp;
                                                 <span class=""fa fa-trash"" onclick=""RemoveProjectDetail(${response.projectDetailId})""></span>
                                            </td>
                                        `;
                                $(`#table_phan_bo_chi_tiet tr[data-id=""${dataPost.Id}""]`).html(htmldtUpdate);
                            }

                            toastr.success('Thông tin chi tiết đã tạo thành công!', 'Thành công', { positionClass: ""toast-top-center"" });
                            $('#modal-hang-muc-phan-bo').html("""");
                            $('#modal-project-itemline').modal(""hide"");

                        } else {
                            toastr.error('Có lỗi khi tạo thông tin chi tiết. Vui lòng thử lại!', 'Lỗi', { positionClass: ""toast-top-center"" })");
                WriteLiteral(@";
                        }
                    },
                    error: function (xhr, status, error) {
                        // Xử lý khi có lỗi xảy ra trong quá trình gọi AJAX
                        alert('Có lỗi khi gửi yêu cầu!');
                    }
                });
            }
        }

        function validateDataDetail() {
            var resultValid = $(""#frmCreateProjectDetail"").validate({
                rules: {
                    ""nhom_hoat_dong"": {
                        required: true,
                    },
                    ""muc_chi"": {
                        required: true,
                    },
                    ""so_luong"": {
                        required: false,
                        number: true,
                        min: 0
                    },

                    ""thanh_tien"": {
                        required: true
                    }

                },
                messages: {
                    ""nhom_hoat_don");
                WriteLiteral(@"g"": ""Nhóm hoạt động không được để trống!"",
                    ""muc_chi"": ""Mục chi không được để trống!"",
                    ""so_luong"": {
                        number: ""Tổng tiền phải là số!""
                    },

                    ""thanh_tien"": {
                        required: ""Thành tiền không được để trống!""
                    }
                },

            }).form();

            return resultValid;

        }

        function RemoveProjectDetail(projectDetailId) {
            Swal.fire({
                title: 'Bạn có chắc chắn?',
                text: ""Bạn sẽ không thể hoàn tác hành động này!"",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Xóa',
                cancelButtonText: 'Hủy'
            }).then((result) => {
                if (result.isConfirmed) {
                    // call ajax
                ");
                WriteLiteral(@"    $.ajax({
                        url: '/Project/DeleteProjectDetail',
                        type: 'GET',
                        data: { Id: projectDetailId },
                        contentType: 'application/json',
                        success: function (response) {
                            if (response.success) {
                                $(`#table_phan_bo_chi_tiet tr[data-id=""${projectDetailId}""]`).remove();

                                toastr.success('Xóa file thành công!', 'Thành công', { positionClass: ""toast-top-center"" });
                            }
                            else {
                                toastr.error('Xóa file thất bại!', 'Lỗi', { positionClass: ""toast-top-center"" });
                            }
                        },
                        error: function (xhr, status, error) {

                            alert('Có lỗi khi gửi yêu cầu!');
                        }
                    });

                }
           ");
                WriteLiteral(@" });
        }

        function EditProjectDetail(projectDetailId) {
            $.ajax({
                url: '/Project/FormCreateProjectDetail',
                type: 'GET',
                data: { Id: projectDetailId },
                contentType: 'application/json',
                success: function (response) {
                    $('#modal-hang-muc-phan-bo').html("""");
                    $('#modal-hang-muc-phan-bo').append(response)
                    $(""#modal-project-itemline"").modal();
                },
                error: function (xhr, status, error) {

                    alert('Có lỗi khi gửi yêu cầu!');
                }
            });
        }

        function ViewDetail(projectDetailId) {
            $.ajax({
                url: '/Project/FormViewDetailProjectDetail',
                type: 'GET',
                data: { Id: projectDetailId },
                contentType: 'application/json',
                success: function (response) {
                  ");
                WriteLiteral(@"  $('#modal-hang-muc-phan-bo').html("""");
                    $('#modal-hang-muc-phan-bo').append(response);
                    $(""#modal-project-itemline"").modal();
                },
                error: function (xhr, status, error) {

                    alert('Có lỗi khi gửi yêu cầu!');
                }
            });
        }

        function AddFormPaymentProfile() {
            // Generate a unique random number
            var randomId = Date.now();
            var htmthstt = ` <tr >
                                    <td>
                                        <input name=""ma_hs_thanh_toan"" id=""a_ma_hs_thanh_toan""  class=""form-control""/>
                                    </td>
                                    <td>
                                        <input name=""ten_hs_thanh_toan"" id=""a_ten_hs_thanh_toan""  class=""form-control"" />
                                    </td>
                                    <td>
                                        <input nam");
                WriteLiteral(@"e=""ghi_chu_hs_thanh_toan"" id=""a_ghi_chu_hs_thanh_toan"" class=""form-control"" />
                                    </td>
                                    <td style=""text-align:center;"">
                                        <span class=""fa fa-check"" onclick=""SaveProfile(${randomId})""></span>
                                        <span class=""fa fa-trash"" onclick=""RemovePaymentProfile(${randomId})""></span>
                                    </td>
                                 </tr>`;
            $('#table_thong_tin_hs_thanh_toan').append(htmthstt);
        }

        function SaveProfile(profileId) {

            // Find the row that contains the clicked icon
            var row = $(`span.fa-check[onclick=""SaveProfile(${profileId})""]`).closest('tr');

            // Retrieve values from the inputs in the row
            var codeInput = row.find('input[name=""ma_hs_thanh_toan""]');
            var nameInput = row.find('input[name=""ten_hs_thanh_toan""]');
            var nameNotes = row");
                WriteLiteral(@".find('input[name=""ghi_chu_hs_thanh_toan""]');
            var code = row.find('input[name=""ma_hs_thanh_toan""]').val();
            var name = row.find('input[name=""ten_hs_thanh_toan""]').val();

            // Validation messages
            var errors = [];

            if (!code || code.trim() === """") {
                errors.push(""Mã không được để trống!"");
            }
            if (!name || name.trim() === """") {
                errors.push(""Tên không được để trống!"");
            }

            // Display validation errors if any
            if (errors.length > 0) {
                toastr.error(errors.join(""<br>""), 'Lỗi', { positionClass: ""toast-top-center"" });
                return;
            }

            // Prepare the data for submission
            var dataPost = {
                Id: 0,
                ProjectDetailId: $(""#PaymentProFileForProjectDetailId"").val(),
                ActiveGroupId: $(""#ActivityGroupId"").val(),
                ProfileId: profileId,
      ");
                WriteLiteral(@"          PaymentInfoCode: code.trim(),
                PaymentInfoName: name.trim(),
                Notes: row.find('input[id=""a_ghi_chu_hs_thanh_toan""]').val() ?.trim()
                };

            // Log the data (optional for debugging)

            $.ajax({
                url: '/Project/CreateProfileForProjectDetail',
                type: 'POST',
                data: JSON.stringify(dataPost),
                contentType: 'application/json',
                success: function (response) {
                    if (response.success) {
                        // Set inputs to readonly
                        codeInput.prop('readonly', true);
                        nameInput.prop('readonly', true);
                        nameNotes.prop('readonly', true);

                        // Remove the onclick event from the save icon
                        row.find('span.fa-check').remove();
                        toastr.success('Thông tin hồ sơ đã tạo thành công!', 'Thành công', { positi");
                WriteLiteral(@"onClass: ""toast-top-center"" });
                    } else {
                        toastr.error('Có lỗi khi tạo thông tin hồ sơ. Vui lòng thử lại!', 'Lỗi', { positionClass: ""toast-top-center"" });
                    }
                },
                error: function (xhr, status, error) {
                    // Xử lý khi có lỗi xảy ra trong quá trình gọi AJAX
                    alert('Có lỗi khi gửi yêu cầu!');
                }
            });
        }

        function RemovePaymentProfile(profileId) {
            Swal.fire({
                title: 'Bạn có chắc chắn?',
                text: ""Bạn sẽ không thể hoàn tác hành động này!"",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Xóa',
                cancelButtonText: 'Hủy'
            }).then((result) => {
                if (result.isConfirmed) {
                    // call a");
                WriteLiteral(@"jax
                    $.ajax({
                        url: '/Project/DeletePaymentProfileOfProjectDetail',
                        type: 'GET',
                        data: {
                            ProjectDetailId: $(""#PaymentProFileForProjectDetailId"").val(),
                            ProfileId: profileId
                        },
                        contentType: 'application/json',
                        success: function (response) {
                            if (response.success) {

                                $(`span.fa-trash[onclick=""RemovePaymentProfile(${profileId})""]`).closest('tr').remove();
                                toastr.success('Xóa thông tin hồ sơ thành công!', 'Thành công');
                            }
                            else {

                                toastr.error('Xóa thông tin hồ sơ  thất bại!', 'Lỗi');
                            }
                        },
                        error: function (xhr, status, error) {
");
                WriteLiteral(@"
                            alert('Có lỗi khi gửi yêu cầu!');
                        }
                    });

                }
            });

        }

        function formatTotalAmount() {
            var inputElement = document.getElementById('a_tong_han_muc');
            var value = inputElement.value.trim();
            if (value && !isNaN(value) || value == ""0"") {
                var rawValue = parseFloat(value);

                var formattedValue = rawValue.toLocaleString('de-DE');
                inputElement.value = formattedValue;
            } else {
                // If invalid, clear both fields
                inputElement.value = '';

            }
        }

        function formatThanhTien() {
            var inputElement = document.getElementById('a_thanh_tien');
            var value = inputElement.value.trim();
            if (value && !isNaN(value) || value == ""0"") {
                var rawValue = parseFloat(value);
                $('#a_thanh_tien_");
                WriteLiteral(@"khong_format').val(rawValue);
                var formattedValue = rawValue.toLocaleString('de-DE');
                inputElement.value = formattedValue;
            } else {
                // If invalid, clear both fields
                inputElement.value = '';

            }
        }

        function formatDonGia() {
            var inputElement = document.getElementById('a_don_gia');
            var value = inputElement.value.trim();
            if (value && !isNaN(value) || value == ""0"") {
                var rawValue = parseFloat(value);
                $('#a_don_gia_khong_format').val(rawValue);
                var formattedValue = rawValue.toLocaleString('de-DE');
                inputElement.value = formattedValue;
                changeSoLuongDonGia();
            } else {
                // If invalid, clear both fields
                inputElement.value = '';

            }
        }

        function changeSoLuongDonGia() {
            var inputElementSoLuong = docum");
                WriteLiteral(@"ent.getElementById('a_so_luong').value.trim();
            var inputElementDonGia = document.getElementById('a_don_gia_khong_format').value.trim();
            if (inputElementSoLuong && !isNaN(inputElementSoLuong) && inputElementDonGia && !isNaN(inputElementDonGia)) {
                var valueSoLuong = parseFloat(inputElementSoLuong);
                var valueDonGia = parseFloat(inputElementDonGia);
                $('#a_thanh_tien').val(valueSoLuong * valueDonGia);
                formatThanhTien();

            }
        }


        

    </script>
");
                EndContext();
            }
            );
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<DAL.Models.ProjectFinancialSummar.ProjectFinancialSummarViewModel> Html { get; private set; }
    }
}
#pragma warning restore 1591
